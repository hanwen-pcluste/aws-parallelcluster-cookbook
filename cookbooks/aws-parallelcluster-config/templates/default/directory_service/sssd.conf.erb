[domain/default]
debug_level = 0x1f0
id_provider = ldap
cache_credentials = True
ldap_schema = AD
ldap_uri = <%=  node['cluster']["directory_service"]["domain_addr"] %> # TODO: use ldaps
ldap_search_base = <%=  node['cluster']["directory_service"]["domain_name"] %>
ldap_default_bind_dn = <%=  node['cluster']["directory_service"]["domain_read_only_user"] %> # TODO: parametrize username
ldap_default_authtok_type = obfuscated_password
ldap_default_authtok = <%= @obfuscated_password %>
ldap_tls_cacert = /etc/openldap/certs/privatekey.pem
ldap_tls_reqcert = never # TODO: use 'require'
ldap_id_mapping = True
ldap_referrals = False
enumerate = True
fallback_homedir = /home/%u
default_shell = /bin/bash
ldap_auth_disable_tls_never_use_in_production = 'true'  # TODO:  use SSL
use_fully_qualified_names = False

[domain/local]
id_provider = local
enumerate = True


[sssd]
config_file_version = 2
services = nss, pam, ssh
domains = default, local
full_name_format = %1\$s

[nss]
filter_users = nobody,root
filter_groups = nobody,root

[pam]
offline_credentials_expiration = 7

